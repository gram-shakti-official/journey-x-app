<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>JourneyX | Best Taxi & Tourist Car Rental Service</title>
    <meta name="description" content="Book affordable outstation taxis, tourist cars, and local cabs with JourneyX. Best rates for Sedan, SUV, and Luxury cars. Advance booking available.">
    <meta name="keywords" content="Taxi booking, Tourist car rental, Outstation cab, Cheap taxi service, JourneyX, Innova Crysta rental, Swift Dzire taxi">
    <meta name="author" content="JourneyX">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB0_3QZj4Yi_ggTtRXQFySjV8NSXtqjsic",
            authDomain: "journeyx-68a6a.firebaseapp.com",
            databaseURL: "https://journeyx-68a6a-default-rtdb.firebaseio.com",
            projectId: "journeyx-68a6a",
            storageBucket: "journeyx-68a6a.firebasestorage.app",
            messagingSenderId: "926400211410",
            appId: "1:926400211410:web:16b8b2dbac2e5e8309800b"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let currentTripType = 'one-way';
        const rates = { "Mini": 9, "Sedan": 12, "Ertiga": 15, "Innova": 20, "Luxury": 65 };

        window.setTripType = (type, btn) => {
            currentTripType = type;
            document.querySelectorAll('.tab-btn').forEach(b => {
                b.classList.remove('bg-white', 'text-blue-900');
                b.classList.add('text-white');
            });
            btn.classList.add('bg-white', 'text-blue-900');
            calculateFare();
        }

        window.calculateFare = () => {
            const dist = parseFloat(document.getElementById('distance').value) || 0;
            const car = document.getElementById('carSelect').value;
            const name = document.getElementById('uName').value;
            const phone = document.getElementById('uPhone').value;
            const pickup = document.getElementById('pickupLoc').value;
            const drop = document.getElementById('dropLoc').value;

            // ‡§Ö‡§ó‡§∞ ‡§∏‡§¨ ‡§≠‡§∞‡§æ ‡§π‡•à ‡§§‡§≠‡•Ä ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§¶‡§ø‡§ñ‡§æ‡§ì
            if(dist > 0 && car && name && phone && pickup && drop) {
                let effDist = (currentTripType === 'package' && dist < 250) ? 250 : dist;
                let total = effDist * rates[car];
                if (total < 1000) total = 1000;

                document.getElementById('fareAmount').innerText = "‚Çπ" + Math.round(total);
                document.getElementById('totalBox').classList.remove('hidden');
            } else {
                document.getElementById('totalBox').classList.add('hidden');
            }
        }

        window.showCustomAlert = (msg) => {
            document.getElementById('alertMessage').innerText = msg;
            document.getElementById('customAlert').classList.remove('hidden');
        };

        window.confirmBooking = () => {
            const date = document.getElementById('bookingDate').value;
            const time = document.getElementById('bookingTime').value;
            if(!date || !time) {
                showCustomAlert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ ‡§ï‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§î‡§∞ ‡§∏‡§Æ‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç!");
                return;
            }
            document.getElementById('agreementPopup').classList.remove('hidden');
        }

        window.finalSubmit = async function() {
            const data = {
                name: document.getElementById('uName').value,
                phone: document.getElementById('uPhone').value,
                pickup: document.getElementById('pickupLoc').value,
                drop: document.getElementById('dropLoc').value,
                dist: document.getElementById('distance').value,
                car: document.getElementById('carSelect').value,
                date: document.getElementById('bookingDate').value,
                time: document.getElementById('bookingTime').value,
                fare: document.getElementById('fareAmount').innerText,
                type: currentTripType,
                timestamp: serverTimestamp()
            };

            try {
                await addDoc(collection(db, "bookings"), data);
                const botToken = "7954151806:AAHy2Q3nePpv_CqA9ymfhEmg33B229ORClI";
                const chatId = "5670868884";
                const msg = `üìÖ *New Advance Booking!*%0Aüë§: ${data.name}%0Aüì±: ${data.phone}%0Aüóì: ${data.date} | ‚è∞: ${data.time}%0Aüìç: ${data.pickup} to ${data.drop}%0Aüöó: ${data.car}%0Aüí∞: ${data.fare}`;
                
                await fetch(`https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${msg}&parse_mode=Markdown`);

                showCustomAlert("‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∏‡§´‡§≤! ‡§π‡§Æ ‡§ú‡§≤‡•ç‡§¶ ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á‡•§");
                setTimeout(() => location.reload(), 3000);
            } catch (e) { showCustomAlert("Error!"); }
        }
    </script>
</head>
<body class="bg-slate-50 flex justify-center">

    <div class="w-full max-w-md bg-white min-h-screen shadow-2xl relative pb-10">
        
        <div class="bg-[#1e3a8a] p-6 rounded-b-[40px] text-white shadow-xl">
            <h1 class="text-3xl font-black italic mb-4 tracking-tighter">JourneyX</h1>
            
            <div class="flex bg-blue-900/50 p-1 rounded-xl text-xs font-bold mb-6">
                <button onclick="setTripType('one-way', this)" class="tab-btn flex-1 bg-white text-blue-900 py-2 rounded-lg">One Way</button>
                <button onclick="setTripType('round-trip', this)" class="tab-btn flex-1 py-2 rounded-lg">Round Trip</button>
                <button onclick="setTripType('package', this)" class="tab-btn flex-1 py-2 rounded-lg">Package</button>
            </div>

            <div class="space-y-3">
                <input id="pickupLoc" oninput="calculateFare()" type="text" placeholder="‡§™‡§ø‡§ï‡§Ö‡§™ (Pickup Address)" class="w-full p-3 rounded-xl bg-blue-800/40 border border-white/10 outline-none text-sm placeholder-blue-200">
                <input id="dropLoc" oninput="calculateFare()" type="text" placeholder="‡§°‡•ç‡§∞‡•â‡§™ (Drop Address)" class="w-full p-3 rounded-xl bg-blue-800/40 border border-white/10 outline-none text-sm placeholder-blue-200">
                
                <div class="flex space-x-2">
                    <div class="flex-1">
                        <label class="text-[9px] uppercase font-bold text-blue-200 ml-1">Journey Date</label>
                        <input id="bookingDate" type="date" class="w-full p-3 rounded-xl bg-blue-800/40 border border-white/10 outline-none text-sm">
                    </div>
                    <div class="flex-1">
                        <label class="text-[9px] uppercase font-bold text-blue-200 ml-1">Time</label>
                        <input id="bookingTime" type="time" class="w-full p-3 rounded-xl bg-blue-800/40 border border-white/10 outline-none text-sm">
                    </div>
                </div>
                <input id="distance" type="number" oninput="calculateFare()" placeholder="‡§ï‡•Å‡§≤ ‡§ï‡§ø‡§≤‡•ã‡§Æ‡•Ä‡§ü‡§∞ (Total KM)" class="w-full p-3 rounded-xl bg-blue-800 text-white outline-none font-bold text-center">
            </div>
        </div>

        <div class="p-6">
            <div class="space-y-4 mb-6">
                <div>
                    <label class="text-[10px] font-bold text-gray-400 uppercase">Car Category</label>
                    <select id="carSelect" onchange="calculateFare()" class="w-full p-4 border rounded-2xl font-bold bg-gray-50 outline-none text-sm">
                        <option value="Mini">Mini (Alto, Kwid & Similar)</option>
                        <option value="Sedan">Sedan (Swift Dzire, Etios & Similar)</option>
                        <option value="Ertiga">SUV (Ertiga, Carens & Similar)</option>
                        <option value="Innova">Premium (Innova Crysta)</option>
                        <option value="Luxury">Luxury (BMW, Audi & Similar)</option>
                    </select>
                </div>
                <input id="uName" oninput="calculateFare()" type="text" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ (Full Name)" class="w-full p-4 border rounded-2xl outline-none text-sm">
                <input id="uPhone" oninput="calculateFare()" type="tel" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ (WhatsApp)" class="w-full p-4 border rounded-2xl outline-none text-sm">
            </div>

            <div id="totalBox" class="hidden bg-green-50 border-2 border-green-100 p-6 rounded-3xl mb-6 text-center shadow-inner">
                <p class="text-green-800 text-xs font-bold uppercase tracking-widest">Estimated Total Fare</p>
                <h2 id="fareAmount" class="text-4xl font-black text-green-900">‚Çπ0</h2>
                <p class="text-[10px] text-gray-400 mt-1">*Excluding Toll, State Tax & Parking.</p>
            </div>

            <button onclick="confirmBooking()" class="w-full bg-[#1e3a8a] text-white py-4 rounded-2xl font-bold text-lg shadow-xl uppercase tracking-tighter">Confirm My Booking</button>
        </div>

        <div id="agreementPopup" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center p-6 z-[100]">
            <div class="bg-red-600 text-white p-8 rounded-[40px] text-center shadow-2xl">
                <h2 class="text-2xl font-bold mb-4">‡§ú‡§º‡§∞‡•Ç‡§∞‡•Ä ‡§∏‡•Ç‡§ö‡§®‡§æ!</h2>
                <p class="text-sm mb-6 leading-relaxed">‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ **State Tax, Toll Tax ‡§î‡§∞ Parking** ‡§∂‡•Å‡§≤‡•ç‡§ï ‡§Ö‡§≤‡§ó ‡§∏‡•á ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç?</p>
                <button onclick="finalSubmit()" class="w-full bg-white text-red-600 py-3 rounded-xl font-bold mb-3 shadow-lg">‡§π‡§æ‡§Å, ‡§Æ‡•à‡§Ç ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•Ç‡§Å</button>
                <button onclick="document.getElementById('agreementPopup').classList.add('hidden')" class="text-xs uppercase font-bold opacity-80">Cancel</button>
            </div>
        </div>

        <div id="customAlert" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-[200] p-6 text-center">
            <div class="bg-white rounded-3xl p-8 max-w-xs w-full shadow-2xl border-t-4 border-blue-900">
                <p id="alertMessage" class="text-gray-800 font-bold mb-6"></p>
                <button onclick="document.getElementById('customAlert').classList.add('hidden')" class="w-full bg-[#1e3a8a] text-white py-3 rounded-xl font-bold">Got it!</button>
            </div>
        </div>

    </div>
</body>
</html>
